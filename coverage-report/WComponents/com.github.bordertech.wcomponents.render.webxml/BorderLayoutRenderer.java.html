<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../resources/report.gif" type="image/gif"/><title>BorderLayoutRenderer.java</title><link rel="stylesheet" href="../../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">WComponents Coverage</a> &gt; <a href="../index.html" class="el_bundle">WComponents</a> &gt; <a href="index.source.html" class="el_package">com.github.bordertech.wcomponents.render.webxml</a> &gt; <span class="el_source">BorderLayoutRenderer.java</span></div><h1>BorderLayoutRenderer.java</h1><pre class="source lang-java linenums">package com.github.bordertech.wcomponents.render.webxml;

import com.github.bordertech.wcomponents.Renderer;
import com.github.bordertech.wcomponents.WComponent;
import com.github.bordertech.wcomponents.WPanel;
import com.github.bordertech.wcomponents.XmlStringBuilder;
import com.github.bordertech.wcomponents.layout.BorderLayout;
import com.github.bordertech.wcomponents.layout.BorderLayout.BorderLayoutConstraint;
import com.github.bordertech.wcomponents.servlet.WebXmlRenderContext;
import com.github.bordertech.wcomponents.util.Duplet;
import java.util.ArrayList;
import java.util.List;

/**
 * This {@link Renderer} renders the children of a {@link WPanel} which have been arranged using a {@link BorderLayout}.
 *
 * @author Yiannis Paschalidis
 * @since 1.0.0
 */
<span class="fc" id="L20">final class BorderLayoutRenderer extends AbstractWebXmlRenderer {</span>

	/**
	 * Paints the given WPanel's children.
	 *
	 * @param component the container to paint.
	 * @param renderContext the RenderContext to paint to.
	 */
	@Override
	public void doRender(final WComponent component, final WebXmlRenderContext renderContext) {
<span class="fc" id="L30">		WPanel panel = (WPanel) component;</span>
<span class="fc" id="L31">		XmlStringBuilder xml = renderContext.getWriter();</span>
<span class="fc" id="L32">		BorderLayout layout = (BorderLayout) panel.getLayout();</span>
<span class="fc" id="L33">		int hgap = layout.getHgap();</span>
<span class="fc" id="L34">		int vgap = layout.getVgap();</span>

<span class="fc" id="L36">		xml.appendTagOpen(&quot;ui:borderLayout&quot;);</span>

<span class="fc bfc" id="L38" title="All 2 branches covered.">		xml.appendOptionalAttribute(&quot;hgap&quot;, hgap &gt; 0, hgap);</span>
<span class="fc bfc" id="L39" title="All 2 branches covered.">		xml.appendOptionalAttribute(&quot;vgap&quot;, vgap &gt; 0, vgap);</span>

<span class="fc" id="L41">		xml.appendClose();</span>

		// Fetch the children and their constraints.
<span class="fc" id="L44">		final int childCount = panel.getChildCount();</span>
<span class="fc" id="L45">		List&lt;Duplet&lt;WComponent, BorderLayoutConstraint&gt;&gt; children = new ArrayList&lt;&gt;(childCount);</span>

<span class="fc bfc" id="L47" title="All 2 branches covered.">		for (int i = 0; i &lt; childCount; i++) {</span>
<span class="fc" id="L48">			WComponent child = panel.getChildAt(i);</span>
<span class="fc" id="L49">			children.add(new Duplet&lt;&gt;(child, getConstraints(panel, child)));</span>
		}

		// Now paint them
<span class="fc" id="L53">		paintChildrenWithConstraint(children, renderContext, BorderLayout.NORTH);</span>
<span class="fc" id="L54">		paintChildrenWithConstraint(children, renderContext, BorderLayout.EAST);</span>
<span class="fc" id="L55">		paintChildrenWithConstraint(children, renderContext, BorderLayout.SOUTH);</span>
<span class="fc" id="L56">		paintChildrenWithConstraint(children, renderContext, BorderLayout.WEST);</span>
<span class="fc" id="L57">		paintChildrenWithConstraint(children, renderContext, BorderLayout.CENTER);</span>

<span class="fc" id="L59">		xml.appendEndTag(&quot;ui:borderLayout&quot;);</span>
<span class="fc" id="L60">	}</span>

	/**
	 * Retrieves the name of the element that will contain components with the given constraint.
	 *
	 * @param constraint the constraint to retrieve the tag for.
	 * @return the tag for the given constraint.
	 */
	private String getTag(final BorderLayoutConstraint constraint) {
<span class="pc bfc" id="L69" title="All 5 branches covered.">		switch (constraint) {</span>
			case EAST:
<span class="fc" id="L71">				return &quot;ui:east&quot;;</span>
			case NORTH:
<span class="fc" id="L73">				return &quot;ui:north&quot;;</span>
			case SOUTH:
<span class="fc" id="L75">				return &quot;ui:south&quot;;</span>
			case WEST:
<span class="fc" id="L77">				return &quot;ui:west&quot;;</span>
			case CENTER:

			default:
<span class="fc" id="L81">				return &quot;ui:center&quot;;</span>
		}
	}

	/**
	 * Paints all the child components with the given constraint.
	 *
	 * @param children the list of potential children to paint.
	 * @param renderContext the RenderContext to paint to.
	 * @param constraint the target constraint.
	 */
	private void paintChildrenWithConstraint(
			final List&lt;Duplet&lt;WComponent, BorderLayoutConstraint&gt;&gt; children,
			final WebXmlRenderContext renderContext, final BorderLayoutConstraint constraint) {
<span class="fc" id="L95">		String containingTag = null;</span>
<span class="fc" id="L96">		XmlStringBuilder xml = renderContext.getWriter();</span>

<span class="fc" id="L98">		final int size = children.size();</span>

<span class="fc bfc" id="L100" title="All 2 branches covered.">		for (int i = 0; i &lt; size; i++) {</span>
<span class="fc" id="L101">			Duplet&lt;WComponent, BorderLayoutConstraint&gt; child = children.get(i);</span>

<span class="fc bfc" id="L103" title="All 2 branches covered.">			if (constraint.equals(child.getSecond())) {</span>
<span class="pc bpc" id="L104" title="1 of 2 branches missed.">				if (containingTag == null) {</span>
<span class="fc" id="L105">					containingTag = getTag(constraint);</span>
<span class="fc" id="L106">					xml.appendTag(containingTag);</span>
				}

<span class="fc" id="L109">				child.getFirst().paint(renderContext);</span>
			}
		}

<span class="fc bfc" id="L113" title="All 2 branches covered.">		if (containingTag != null) {</span>
<span class="fc" id="L114">			xml.appendEndTag(containingTag);</span>
		}
<span class="fc" id="L116">	}</span>

	/**
	 * Retrieves the layout constraint for the given component. If the constraint is incorrectly configured, an
	 * {@link IllegalStateException} will be thrown.
	 *
	 * @param panel the panel which contains the child
	 * @param child the component to retrieve the constraint for.
	 *
	 * @return the layout constraint for the given component.
	 */
	private static BorderLayoutConstraint getConstraints(final WPanel panel, final WComponent child) {
<span class="fc" id="L128">		Object constraints = panel.getLayoutConstraints(child);</span>

<span class="fc bfc" id="L130" title="All 2 branches covered.">		if (constraints instanceof BorderLayoutConstraint) {</span>
<span class="fc" id="L131">			return (BorderLayoutConstraint) constraints;</span>
<span class="pc bpc" id="L132" title="1 of 2 branches missed.">		} else if (constraints == null) {</span>
<span class="fc" id="L133">			return BorderLayout.CENTER;</span>
		} else {
<span class="nc" id="L135">			throw new IllegalStateException(&quot;Constraint must be a BorderLayoutConstraint&quot;);</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>