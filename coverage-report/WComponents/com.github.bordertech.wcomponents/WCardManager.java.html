<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../resources/report.gif" type="image/gif"/><title>WCardManager.java</title><link rel="stylesheet" href="../../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">WComponents Coverage</a> &gt; <a href="../index.html" class="el_bundle">WComponents</a> &gt; <a href="index.source.html" class="el_package">com.github.bordertech.wcomponents</a> &gt; <span class="el_source">WCardManager.java</span></div><h1>WCardManager.java</h1><pre class="source lang-java linenums">package com.github.bordertech.wcomponents;

import com.github.bordertech.wcomponents.validation.Diagnostic;
import java.util.List;

/**
 * &lt;p&gt;
 * A WCardManager is a wcomponent used to control the visibility of its child components. It can help to think of a
 * WCardManager as a deck of cards, where only the top most card is visible. The WCardManager enables you to add cards
 * to the deck (using the &quot;add&quot; method) and to select which of the cards to place on the top of the deck (using the
 * &quot;makeVisible&quot; method).
 * &lt;/p&gt;
 * &lt;p&gt;
 * You would expect a WComponent that is using a WCardManager to support its functionality, to add all the cards it will
 * need in its constructor. Note that the first card added will be the default visible component. Implementations of the
 * Action interface are normally used to change which card is visible.
 * &lt;/p&gt;
 *
 * @author James Gifford
 * @author Martin Shevchenko
 * @since 1.0.0
 */
public class WCardManager extends AbstractMutableContainer {

	/**
	 * Cards are added to this container to exclude them from standard processing.
	 */
<span class="fc" id="L28">	private final WInvisibleContainer cardContainer = new WInvisibleContainer();</span>

	/**
	 * Creates a WCardManager.
	 */
<span class="fc" id="L33">	public WCardManager() {</span>
<span class="fc" id="L34">		super.add(cardContainer);</span>
<span class="fc" id="L35">	}</span>

	/**
	 * @return the card container
	 */
	protected WInvisibleContainer getCardContainer() {
<span class="fc" id="L41">		return cardContainer;</span>
	}

	//================================
	// Attributes
	/**
	 * Returns the visible component (card) for the given context.
	 *
	 * @return the visible component.
	 */
	public WComponent getVisible() {
<span class="fc" id="L52">		CardManagerModel model = getComponentModel();</span>
<span class="fc" id="L53">		return model.visibleComponent;</span>
	}

	/**
	 * Sets the visible component (card) for the given context.
	 *
	 * @param component the visible component.
	 */
	public void makeVisible(final WComponent component) {
<span class="fc bfc" id="L62" title="All 2 branches covered.">		if (component.getParent() != getCardContainer()) {</span>
<span class="fc" id="L63">			throw new IllegalArgumentException(</span>
					&quot;Attempted to make a component visible which is not contained in this WCardManager&quot;);
		}

<span class="fc" id="L67">		CardManagerModel model = getOrCreateComponentModel();</span>
<span class="fc" id="L68">		model.visibleComponent = component;</span>
<span class="fc" id="L69">	}</span>

	//================================
	// Structure
	/**
	 * Override add so that components are added to the (invisible) container.
	 *
	 * @param component the component to add.
	 */
	@Override
	public void add(final WComponent component) {
<span class="fc" id="L80">		getCardContainer().add(component);</span>
<span class="fc" id="L81">		CardManagerModel model = getComponentModel();</span>

<span class="fc bfc" id="L83" title="All 2 branches covered.">		if (model.visibleComponent == null) {</span>
<span class="fc" id="L84">			model.visibleComponent = component;</span>
		}
<span class="fc" id="L86">	}</span>

	/**
	 * Override remove so that components are removed from the (invisible) container.
	 *
	 * @param component the component to remove.
	 */
	@Override
	public void remove(final WComponent component) {
<span class="fc" id="L95">		getCardContainer().remove(component);</span>
<span class="fc" id="L96">	}</span>

	/**
	 * Override removeAll so that all components are removed from the (invisible) container.
	 */
	@Override
	public void removeAll() {
<span class="nc" id="L103">		getCardContainer().removeAll();</span>
<span class="nc" id="L104">	}</span>

	/**
	 * Since none of the children are visible to standard processing, handleRequest has been overridden so that the
	 * visible card is processed.
	 *
	 * @param request the request being responded to.
	 */
	@Override
	public void handleRequest(final Request request) {
<span class="fc" id="L114">		super.handleRequest(request);</span>

<span class="fc" id="L116">		WComponent visibleDialog = getVisible();</span>

<span class="pc bpc" id="L118" title="1 of 2 branches missed.">		if (visibleDialog != null) {</span>
<span class="fc" id="L119">			visibleDialog.serviceRequest(request);</span>
		}
<span class="fc" id="L121">	}</span>

	/**
	 * Since none of the children are visible to standard processing, preparePaintComponent has been overridden so that
	 * the visible card is prepared.
	 *
	 * @param request the request being responded to.
	 */
	@Override
	protected void preparePaintComponent(final Request request) {
<span class="fc" id="L131">		super.preparePaintComponent(request);</span>

<span class="fc" id="L133">		WComponent visibleDialog = getVisible();</span>

<span class="pc bpc" id="L135" title="1 of 2 branches missed.">		if (visibleDialog != null) {</span>
<span class="fc" id="L136">			visibleDialog.preparePaint(request);</span>
		}
<span class="fc" id="L138">	}</span>

	/**
	 * Since none of the children are visible to standard processing, paintComponent has been overridden so that the
	 * visible card is painted.
	 *
	 * @param renderContext the RenderContext to paint to.
	 */
	@Override
	protected void paintComponent(final RenderContext renderContext) {
<span class="fc" id="L148">		super.paintComponent(renderContext);</span>

<span class="fc" id="L150">		WComponent visibleDialog = getVisible();</span>

<span class="pc bpc" id="L152" title="1 of 2 branches missed.">		if (visibleDialog != null) {</span>
<span class="fc" id="L153">			visibleDialog.paint(renderContext);</span>
		}
<span class="fc" id="L155">	}</span>

	/**
	 * Since none of the children are visible to standard processing, validateComponent has been overridden so that the
	 * visible card is processed.
	 *
	 * @param diags the list to add validation diagnostics to.
	 */
	@Override
	protected void validateComponent(final List&lt;Diagnostic&gt; diags) {
<span class="fc" id="L165">		super.validateComponent(diags);</span>

<span class="fc" id="L167">		WComponent visibleDialog = getVisible();</span>

<span class="pc bpc" id="L169" title="1 of 2 branches missed.">		if (visibleDialog != null) {</span>
<span class="fc" id="L170">			visibleDialog.validate(diags);</span>
		}
<span class="fc" id="L172">	}</span>

	/**
	 * Override method to show Error indicators on the visible card.
	 *
	 * @param diags the list of diagnostics containing errors.
	 */
	@Override
	public void showErrorIndicators(final List&lt;Diagnostic&gt; diags) {
<span class="nc" id="L181">		WComponent visibleComponent = getVisible();</span>
<span class="nc" id="L182">		visibleComponent.showErrorIndicators(diags);</span>
<span class="nc" id="L183">	}</span>

	/**
	 * Override method to show Warning indicators on the visible card.
	 *
	 * @param diags the list of diagnostics containing warnings.
	 */
	@Override
	public void showWarningIndicators(final List&lt;Diagnostic&gt; diags) {
<span class="nc" id="L192">		WComponent visibleComponent = getVisible();</span>
<span class="nc" id="L193">		visibleComponent.showWarningIndicators(diags);</span>
<span class="nc" id="L194">	}</span>

	/**
	 * @return a String representation of this component, for debugging purposes.
	 */
	@Override
	public String toString() {
<span class="nc" id="L201">		int index = getCardContainer().getIndexOfChild(getVisible());</span>
<span class="nc" id="L202">		List&lt;WComponent&gt; cards = getCardContainer().getComponentModel().getChildren();</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">		WComponent[] children = cards == null ? new WComponent[0] : cards.toArray(</span>
<span class="nc" id="L204">				new WComponent[cards.size()]);</span>

<span class="nc" id="L206">		return toString(&quot;active=&quot; + index, -1, -1) + childrenToString(children);</span>
	}

	// --------------------------------
	// Extrinsic state management
	/**
	 * Creates a new component model appropriate for this component.
	 *
	 * @return a new CardManagerModel.
	 */
	@Override
	protected CardManagerModel newComponentModel() {
<span class="fc" id="L218">		return new CardManagerModel();</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@Override // For type safety only
	protected CardManagerModel getComponentModel() {
<span class="fc" id="L226">		return (CardManagerModel) super.getComponentModel();</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@Override // For type safety only
	protected CardManagerModel getOrCreateComponentModel() {
<span class="fc" id="L234">		return (CardManagerModel) super.getOrCreateComponentModel();</span>
	}

	/**
	 * Holds the extrinsic state information of a CardManager.
	 */
<span class="fc" id="L240">	public static class CardManagerModel extends ComponentModel {</span>

		/**
		 * The currently visible component.
		 */
		private WComponent visibleComponent;
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>