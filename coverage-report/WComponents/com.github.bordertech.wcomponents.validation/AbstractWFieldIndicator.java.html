<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../resources/report.gif" type="image/gif"/><title>AbstractWFieldIndicator.java</title><link rel="stylesheet" href="../../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">WComponents Coverage</a> &gt; <a href="../index.html" class="el_bundle">WComponents</a> &gt; <a href="index.source.html" class="el_package">com.github.bordertech.wcomponents.validation</a> &gt; <span class="el_source">AbstractWFieldIndicator.java</span></div><h1>AbstractWFieldIndicator.java</h1><pre class="source lang-java linenums">package com.github.bordertech.wcomponents.validation;

import com.github.bordertech.wcomponents.AbstractWComponent;
import com.github.bordertech.wcomponents.ComponentModel;
import com.github.bordertech.wcomponents.UIContext;
import com.github.bordertech.wcomponents.UIContextHolder;
import com.github.bordertech.wcomponents.WComponent;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

/**
 * A component to display a warning/error (or other) message that can be associated with an input field.
 *
 * @author Darian Bridge
 * @version 9/10/2009
 * @since 1.0.0
 */
public abstract class AbstractWFieldIndicator extends AbstractWComponent {

	/**
	 * The field that this indicator is related to.
	 */
	private final WComponent relatedField;

	/**
	 * Remember the dynamic list of indicator diagnostics.
	 */
<span class="fc" id="L29">	public static class FieldIndicatorModel extends ComponentModel {</span>

		/**
		 * A List of Diagnostic objects.
		 */
<span class="fc" id="L34">		private final List&lt;Diagnostic&gt; diagnostics = new ArrayList&lt;&gt;();</span>
	}

	/**
	 * Constructor. Set the field that the indicator is related to.
	 *
	 * @param relatedField The related field.
	 */
<span class="fc" id="L42">	public AbstractWFieldIndicator(final WComponent relatedField) {</span>
<span class="fc" id="L43">		this.relatedField = relatedField;</span>
<span class="fc" id="L44">	}</span>

	// ================================
	// Validation
	/**
	 * Iterates over the {@link Diagnostic}s and finds the diagnostics that related to {@link #relatedField}.
	 *
	 * @param diags A List of Diagnostic objects.
	 * @param severity A Diagnostic severity code. e.g. {@link Diagnostic#ERROR}
	 */
	protected void showIndicatorsForComponent(final List&lt;Diagnostic&gt; diags, final int severity) {
<span class="fc" id="L55">		FieldIndicatorModel model = getOrCreateComponentModel();</span>
<span class="fc" id="L56">		model.diagnostics.clear();</span>
<span class="fc" id="L57">		UIContext uic = UIContextHolder.getCurrent();</span>

<span class="fc bfc" id="L59" title="All 2 branches covered.">		for (int i = 0; i &lt; diags.size(); i++) {</span>
<span class="fc" id="L60">			Diagnostic diagnostic = diags.get(i);</span>

<span class="pc bpc" id="L62" title="1 of 4 branches missed.">			if (diagnostic.getSeverity() == severity &amp;&amp; uic == diagnostic.getContext()</span>
					// To support repeated components.
<span class="fc bfc" id="L64" title="All 2 branches covered.">					&amp;&amp; relatedField == diagnostic.getComponent()) {</span>
<span class="fc" id="L65">				model.diagnostics.add(diagnostic);</span>
			}
		}
<span class="fc" id="L68">	}</span>

	/**
	 * Provide subclasses with access to the related field.
	 *
	 * @return The Related Field.
	 */
	protected WComponent getRelatedField() {
<span class="fc" id="L76">		return this.relatedField;</span>
	}

	/**
	 * Returns the id of the related field ({@link #relatedField}).
	 *
	 * @return The id of the field that is related to this indicator.
	 */
	public String getRelatedFieldId() {
<span class="fc" id="L85">		return relatedField.getId();</span>
	}

	/**
	 * Return the diagnostics for this indicator.
	 *
	 * @return A list of diagnostics (may be empty) for this indicator.
	 */
	public List&lt;Diagnostic&gt; getDiagnostics() {
<span class="fc" id="L94">		FieldIndicatorModel model = getComponentModel();</span>
<span class="fc" id="L95">		return Collections.unmodifiableList(model.diagnostics);</span>
	}

	// --------------------------------
	// Extrinsic state management
	/**
	 * @return The FieldIndicatorModel.
	 */
	@Override
	protected FieldIndicatorModel getComponentModel() {
<span class="fc" id="L105">		return (FieldIndicatorModel) super.getComponentModel();</span>
	}

	/**
	 * @return The FieldIndicatorModel.
	 */
	@Override
	protected FieldIndicatorModel getOrCreateComponentModel() {
<span class="fc" id="L113">		return (FieldIndicatorModel) super.getOrCreateComponentModel();</span>
	}

	/**
	 * @return a new Component Model.
	 */
	@Override
	protected ComponentModel newComponentModel() {
<span class="fc" id="L121">		return new FieldIndicatorModel();</span>
	}

	/**
	 * Used to determine the type of field indicator.
	 */
<span class="pc" id="L127">	public enum FieldIndicatorType {</span>
		/**
		 * Information Type.
		 */
<span class="fc" id="L131">		INFO,</span>
		/**
		 * Warning Type.
		 */
<span class="fc" id="L135">		WARN,</span>
		/**
		 * Error Type.
		 */
<span class="fc" id="L139">		ERROR</span>
	};

	/**
	 * Return the type of field indicator.
	 *
	 * @return the field indicator type.
	 */
	public abstract FieldIndicatorType getFieldIndicatorType();

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>